<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>å¥‡è¿¹æŠ•ç¥¨æ’è¡Œæ¦œ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href="f.png">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"/>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; background: #f7fafc; }
    .navbar { background: #2260a9; color: #fff; }
    .navbar-brand { color: #fff !important; font-size: 1.7rem; font-weight: bold; }
    .nav-link, .lang-btn { color: #fff !important; font-size: 1.1rem; }
    .lang-btn { background: #2260a9; border:none; margin-left: 15px; outline:none; font-size: 1.07rem; border-radius: 19px; padding: 4px 16px; transition: background .2s;}
    .lang-btn.active, .lang-btn:hover { background: #184574; color: #fff;}
    .miracle-rank-header { background: #2260a9; color: #fff; padding: 38px 0 18px 0; text-align: center; }
    .miracle-rank-header h1 { font-size: 2.1rem; font-weight: 700; }
    .miracle-rank-header p { font-size: 1.08rem; opacity: .92; }
    .miracle-table-wrap { background: #fff; border-radius: 12px; box-shadow: 0 2px 18px #2260a922; margin: 32px auto 18px auto; max-width: 700px; padding: 18px 10px 10px 10px; }
    .miracle-table th, .miracle-table td { vertical-align: middle; text-align: center; }
    .miracle-table th { background: #eaf1fa; color: #2260a9; font-size: 1.08rem; }
    .miracle-table td { font-size: 1.01rem; }
    .miracle-img { width: 48px; height: 48px; object-fit: cover; border-radius: 8px; border: 1px solid #eee; }
    .rank-medal { font-size: 1.3rem; }
    .miracle-valuation { font-weight: 600; color: #28a745; }
    .footer { background:#234; color:#fff; padding:24px 0; margin-top:40px;}
    .footer a { color:#c7e3ff;}
    @media (max-width: 900px) {
      .miracle-table-wrap { max-width: 99vw; }
      .miracle-table th, .miracle-table td { font-size: .97rem; }
      .navbar .ml-auto { margin-left: 0 !important;}
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg">
    <a class="navbar-brand" id="nav_title" href="index.html">Global RWA Asset Directory</a>
    <div class="ml-auto d-flex align-items-center">
      <a class="nav-link d-inline" id="nav_about" href="about.html">About RWA</a>
      <button class="lang-btn active" id="btn-en" onclick="switchLang('en')">EN</button>
      <button class="lang-btn" id="btn-zh" onclick="switchLang('zh')">ä¸­</button>
    </div>
  </nav>
  <div class="miracle-rank-header">
    <h1 id="page_title">å¥‡è¿¹æŠ•ç¥¨æ’è¡Œæ¦œ</h1>
    <p id="page_desc">ä¸ºä½ å–œæ¬¢çš„å¥‡è¿¹æŠ•ç¥¨ï¼ŒæŠ•ç¥¨åå¯å®æ—¶çœ‹åˆ°æœ€æ–°æ’å</p>
  </div>
  <div class="container" style="max-width:700px; margin: 0 auto 24px auto;">
    <div id="vote-section" style="background:#fff; border-radius:12px; box-shadow:0 2px 18px #e74c3c22; padding:18px 10px 10px 10px; margin-bottom:24px;">
  <h5 id="vote_title" style="color:#2260a9; font-weight:700;">ä¸ºä¸–ç•Œå¥‡è¿¹æŠ•ç¥¨</h5>
      <div id="miracle-vote-list"></div>
  <div id="vote_tip" style="color:#888; font-size:0.98rem; margin-top:8px;">æ¯ä¸ªå¥‡è¿¹æ¯å¤©å¯æŠ•1ç¥¨</div>
    </div>
    <div class="miracle-table-wrap">
      <table class="table miracle-table">
        <thead>
          <tr>
            <th id="th_rank">æ’å</th>
            <th id="th_miracle">å¥‡è¿¹</th>
            <th id="th_votes">ç¥¨æ•°</th>
            <th id="th_valuation">å¥‡è¿¹ä¼°å€¼ï¼ˆäº¿å…ƒï¼‰</th>
          </tr>
        </thead>
        <tbody id="miracle-rank-tbody">
          <!-- JSå¡«å…… -->
        </tbody>
      </table>
    </div>
  </div>
  <div class="footer">
    <div class="container">
      <div class="row">
        <div class="col-md-7">
          <span id="footer_text">Â© 2025 Global RWA Asset Directory | Demo data for learning only</span>
        </div>
        <div class="col-md-5 text-right">
          <span id="footer_contact">Contact: <a href="mailto:your@email.com">your@email.com</a></span>
        </div>
      </div>
    </div>
  </div>
  <script>
    // å¤šè¯­è¨€æ•°æ®
    const langData = {
      en: {
        nav_title: "Global RWA Asset Directory",
        nav_about: "About RWA",
        page_title: "Miracle Voting Ranking",
        page_desc: "Vote for your favorite wonder and see the latest ranking instantly.",
        vote_title: "Vote for World Wonders",
        vote_tip: "You can vote for each wonder once per day",
        th_rank: "Rank",
        th_miracle: "Wonder",
        th_votes: "Votes",
        th_valuation: "Valuation (100M CNY)",
        btn_vote: "Vote",
        btn_voted: "Voted",
        footer_text: "Â© 2025 | The prediction results are for reference only and are not endorsed.",
        footer_contact: 'Contact: <a href="mailto:holyspiritgodsky@gmail.com">holyspiritgodsky@gmail.com</a>',
      },
      zh: {
        nav_title: "å…¨çƒRWAèµ„äº§ç›®å½•",
        nav_about: "å…³äºèµ„äº§",
        page_title: "å¥‡è¿¹æŠ•ç¥¨æ’è¡Œæ¦œ",
        page_desc: "ä¸ºä½ å–œæ¬¢çš„å¥‡è¿¹æŠ•ç¥¨ï¼ŒæŠ•ç¥¨åå¯å®æ—¶çœ‹åˆ°æœ€æ–°æ’å",
        vote_title: "ä¸ºä¸–ç•Œå¥‡è¿¹æŠ•ç¥¨",
        vote_tip: "æ¯ä¸ªå¥‡è¿¹æ¯å¤©å¯æŠ•1ç¥¨",
        th_rank: "æ’å",
        th_miracle: "å¥‡è¿¹",
        th_votes: "ç¥¨æ•°",
        th_valuation: "å¥‡è¿¹ä¼°å€¼ï¼ˆäº¿å…ƒï¼‰",
        btn_vote: "æŠ•ç¥¨",
        btn_voted: "å·²æŠ•ç¥¨",
        footer_text: "Â© 2025 å…¨çƒRWAèµ„äº§ç›®å½• | ä»…ä¾›å­¦ä¹ äº¤æµï¼Œæ•°æ®ä¸ºç¤ºä¾‹",
        footer_contact: 'è”ç³»æ–¹å¼ï¼š<a href="mailto:your@email.com">your@email.com</a>',
      }
    };
    function switchLang(lang) {
      document.getElementById("btn-en").classList.toggle("active", lang === "en");
      document.getElementById("btn-zh").classList.toggle("active", lang === "zh");
      for (const key in langData[lang]) {
        const el = document.getElementById(key);
        if (el) {
          if (key === "footer_contact") el.innerHTML = langData[lang][key];
          else el.textContent = langData[lang][key];
        }
      }
      // æŠ•ç¥¨æŒ‰é’®å¤šè¯­è¨€
      renderVoteSection(lang);
      renderRank(lang);
      document.documentElement.lang = lang;
      localStorage.setItem('miracle_lang', lang);
    }
    // è®°å¿†è¯­è¨€
    let userLang = localStorage.getItem('miracle_lang') || 'zh';
    // ...existing code...
    // å¥‡è¿¹åˆ—è¡¨
    const MIRACLES = [
      { id: 1, name: 'å‰è¨é‡‘å­—å¡”', img: 'images/pyramid.png', weight: 1 },
      { id: 2, name: 'ä¸‡é‡Œé•¿åŸ', img: 'images/greatwall.png', weight: 1 },
      { id: 3, name: 'è‡ªç”±å¥³ç¥åƒ', img: 'images/statueofliberty.png', weight: 3 },
      { id: 4, name: 'ç½—é©¬å¤§ç«æŠ€åœº', img: 'images/colosseum.png', weight: 4 },
      { id: 5, name: 'æ³°å§¬é™µ', img: 'images/tajmahal.png', weight: 1.2 }
    ];
    // åˆå§‹ç¥¨æ•°
  // å¼ºåˆ¶é‡ç½®ç¥¨æ•°ï¼ˆè°ƒè¯•ç”¨ï¼Œæ­£å¼å¯ç§»é™¤ï¼‰
  localStorage.removeItem('miracle_votes_v1');
  localStorage.removeItem('miracle_vote_date_v1');
  const defaultVotes = [12, 8, 5, 3, 2];
    // æœ¬åœ°å­˜å‚¨key
    const VOTE_KEY = 'miracle_votes_v1';
    const VOTE_DATE_KEY = 'miracle_vote_date_v1';
    // è·å–ç¥¨æ•°
    function getVotes() {
      let votes = localStorage.getItem(VOTE_KEY);
      if (votes) {
        try { votes = JSON.parse(votes); } catch { votes = defaultVotes.slice(); }
        if (!Array.isArray(votes) || votes.length !== MIRACLES.length) votes = defaultVotes.slice();
      } else {
        votes = defaultVotes.slice();
      }
      return votes;
    }
    // ä¿å­˜ç¥¨æ•°
    function setVotes(votes) {
      localStorage.setItem(VOTE_KEY, JSON.stringify(votes));
    }
    // è·å–ä»Šæ—¥æŠ•ç¥¨è®°å½•
    function getTodayVote() {
      let rec = localStorage.getItem(VOTE_DATE_KEY);
      if (rec) {
        try { rec = JSON.parse(rec); } catch { rec = {}; }
      } else {
        rec = {};
      }
      // æ¸…ç†éä»Šæ—¥
      const today = new Date().toISOString().slice(0,10);
      if (rec.date !== today) return { date: today, voted: [] };
      return rec;
    }
    // ä¿å­˜ä»Šæ—¥æŠ•ç¥¨è®°å½•
    function setTodayVote(rec) {
      localStorage.setItem(VOTE_DATE_KEY, JSON.stringify(rec));
    }
    // æ¸²æŸ“æŠ•ç¥¨åŒº
    function renderVoteSection(lang = userLang) {
      const voteList = document.getElementById('miracle-vote-list');
      voteList.innerHTML = '';
      const todayRec = getTodayVote();
      MIRACLES.forEach((m, idx) => {
        const voted = todayRec.voted && todayRec.voted.includes(m.id);
        voteList.innerHTML += `
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;">
            <div style="display:flex;align-items:center;">
              <img src="${m.img}" class="miracle-img mr-2" alt="${m.name}">
              <span style="font-size:1.13rem;font-weight:600;">${m.name}</span>
            </div>
            <button class="btn btn-sm btn-primary" id="vote_btn_${m.id}" ${voted?'disabled':''}>${voted?langData[lang].btn_voted:langData[lang].btn_vote}</button>
          </div>
        `;
      });
      // ç»‘å®šäº‹ä»¶
      MIRACLES.forEach((m, idx) => {
        const btn = document.getElementById('vote_btn_'+m.id);
        if (btn && !btn.disabled) {
          btn.onclick = function() {
            let votes = getVotes();
            votes[idx]++;
            setVotes(votes);
            // è®°å½•ä»Šæ—¥æŠ•ç¥¨
            let rec = getTodayVote();
            if (!rec.voted) rec.voted = [];
            rec.date = new Date().toISOString().slice(0,10);
            rec.voted.push(m.id);
            setTodayVote(rec);
            renderVoteSection(lang);
            renderRank(lang);
          };
        }
      });
    }
    // ä¼°å€¼åˆ†é…ï¼ˆç¥¨æ•°è¶Šå¤šä¼°å€¼è¶Šé«˜ï¼Œé€’å¢ï¼‰
    // è®¾å®šï¼šä¼°å€¼ = 100 + ç¥¨æ•° * 20ï¼ˆå¯è°ƒæ•´ï¼‰
    function getValuationByVotes(votes) {
      return (100 + votes * 20);
    }
    // æ¸²æŸ“æ’è¡Œæ¦œ
    function renderRank(lang = userLang) {
      const votes = getVotes();
      // è®¡ç®—åŠ æƒç¥¨æ•°
      const miracleRank = MIRACLES.map((m, i) => {
        const weightedVotes = votes[i] * m.weight;
        return { ...m, votes: votes[i], weightedVotes };
      })
        .sort((a, b) => b.weightedVotes - a.weightedVotes)
        .map((m, idx, arr) => ({ ...m, rank: idx + 1, valuation: getValuationByVotes(m.weightedVotes) }));
      const tbody = document.getElementById('miracle-rank-tbody');
      tbody.innerHTML = '';
      miracleRank.forEach(m => {
        const medal = m.rank === 1 ? 'ğŸ¥‡' : m.rank === 2 ? 'ğŸ¥ˆ' : m.rank === 3 ? 'ğŸ¥‰' : m.rank;
        tbody.innerHTML += `
          <tr>
            <td><span class="rank-medal">${medal}</span></td>
            <td><img src="${m.img}" class="miracle-img mr-2" alt="${m.name}">${m.name}</td>
            <td>${m.votes.toLocaleString()}<br><span style="color:#888;font-size:0.97em;">(${m.weightedVotes.toLocaleString(undefined,{maximumFractionDigits:1})})</span></td>
            <td class="miracle-valuation">${m.valuation.toLocaleString()}</td>
          </tr>
        `;
      });
    }
    // åˆå§‹åŒ–
    renderVoteSection(userLang);
    renderRank(userLang);
    switchLang(userLang);
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>è‚¡ç¥¨è¡Œä¸šåˆ†æé¢„æµ‹ç³»ç»Ÿ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href="f.png">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"/>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; background: #f7fafc; }
    .navbar { background: #2260a9; color: #fff; }
    .navbar-brand { color: #fff !important; font-size: 1.7rem; font-weight: bold; }
    .nav-link, .lang-btn { color: #fff !important; font-size: 1.1rem; }
    .lang-btn { background: #2260a9; border:none; margin-left: 15px; outline:none; font-size: 1.07rem; border-radius: 19px; padding: 4px 16px; transition: background .2s;}
    .lang-btn.active, .lang-btn:hover { background: #184574; color: #fff;}
    .news-card { background: #fff; border-radius: 14px; box-shadow: 0 2px 18px #e0e6ef; padding: 24px; margin-bottom: 20px; }
    .news-title { color: #2260a9; font-weight: 700; font-size: 1.15rem; margin-bottom: 12px; }
    .news-content { color: #184574; font-size: 1.05rem; line-height: 1.6; }
    .news-time { color: #6c757d; font-size: 0.9rem; margin-top: 8px; }
    .prediction-card { background: #fff; border-radius: 14px; box-shadow: 0 2px 18px #e0e6ef; padding: 24px; }
    .sector-item { border-left: 4px solid #2260a9; padding: 12px 16px; margin: 12px 0; background: #f8f9ff; border-radius: 0 8px 8px 0; }
    .sector-name { font-weight: 700; color: #2260a9; font-size: 1.1rem; }
    .sector-impact { color: #184574; font-size: 1.05rem; margin: 8px 0; }
    .impact-positive { color: #28a745; font-weight: 600; }
    .impact-negative { color: #dc3545; font-weight: 600; }
    .impact-neutral { color: #6c757d; font-weight: 600; }
    .loading { text-align: center; padding: 40px; color: #2260a9; }
    .refresh-btn { background: #2260a9; color: #fff; border: none; border-radius: 25px; padding: 12px 24px; font-weight: 600; transition: background 0.2s; }
    .refresh-btn:hover { background: #184574; color: #fff; }
    .news-source { color: #2260a9; font-weight: 600; font-size: 0.95rem; }
    .prediction-summary { background: #f0f8ff; border: 2px solid #2260a9; border-radius: 12px; padding: 20px; margin-bottom: 24px; }
    .summary-title { color: #2260a9; font-weight: 700; font-size: 1.3rem; margin-bottom: 16px; }
    .comic-container { margin-top: 20px; padding: 16px; background: #f8f9ff; border-radius: 12px; border: 2px dashed #2260a9; }
    .comic-title { color: #2260a9; font-weight: 700; font-size: 1.1rem; margin-bottom: 12px; text-align: center; }
    .comic-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
    .comic-panel { background: #fff; border: 2px solid #2260a9; border-radius: 8px; padding: 12px; text-align: center; position: relative; min-height: 120px; display: flex; flex-direction: column; justify-content: center; }
    .comic-panel-number { position: absolute; top: 4px; left: 6px; background: #2260a9; color: #fff; border-radius: 50%; width: 20px; height: 20px; font-size: 0.8rem; display: flex; align-items: center; justify-content: center; font-weight: bold; }
    .comic-text { font-size: 0.9rem; color: #184574; line-height: 1.4; margin-top: 8px; }
    .comic-emoji { font-size: 1.5rem; margin-bottom: 4px; }
    .comic-image { width: 60px; height: 60px; object-fit: cover; border-radius: 6px; margin-bottom: 8px; }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg">
    <a class="navbar-brand" id="nav_title" href="index.html">è‚¡ç¥¨è¡Œä¸šåˆ†æé¢„æµ‹ç³»ç»Ÿ</a>
    <div class="ml-auto d-flex align-items-center">
      <a class="nav-link d-inline" id="nav_about" href="about.html">å…³äºç³»ç»Ÿ</a>
      <button class="lang-btn active" id="btn-zh" onclick="switchLang('zh')">ä¸­</button>
      <button class="lang-btn" id="btn-en" onclick="switchLang('en')">EN</button>
    </div>
  </nav>

  <div class="container" style="max-width:1200px; margin:38px auto 0 auto;">
    <div class="row">
      <div class="col-12 text-center mb-4">
        <h1 style="color:#2260a9; font-weight:700;">åˆ†ææ–°é—» é¢„æµ‹è‚¡ç¥¨è¡Œä¸šèµ°åŠ¿</h1>
        <p style="color:#184574; font-size:1.1rem;">åŸºäºè·¯é€ç¤¾é‡è¦æ–°é—»ï¼Œæ™ºèƒ½åˆ†æå¸‚åœºåŠ¨æ€ï¼Œç²¾å‡†é¢„æµ‹å„è¡Œä¸šè‚¡ç¥¨èµ°åŠ¿</p>
        <button class="refresh-btn" onclick="refreshNews()">
          <i class="fas fa-sync-alt"></i> è·å–æœ€æ–°æ–°é—»åˆ†æ
        </button>
      </div>
    </div>

    <div class="row">
      <!-- æ–°é—»åŒºåŸŸ -->
      <div class="col-lg-7">
        <h3 style="color:#2260a9; font-weight:700; margin-bottom:20px;">
          <i class="fas fa-newspaper"></i> ä»Šæ—¥é‡è¦æ–°é—»
        </h3>
        <div id="newsContainer">
          <div class="loading">
            <div class="spinner-border text-primary" role="status">
              <span class="sr-only">åŠ è½½ä¸­...</span>
            </div>
            <p>æ­£åœ¨è·å–è·¯é€ç¤¾æœ€æ–°æ–°é—»...</p>
          </div>
        </div>
      </div>

      <!-- é¢„æµ‹åŒºåŸŸ -->
      <div class="col-lg-5">
        <h3 style="color:#2260a9; font-weight:700; margin-bottom:20px;">
          <i class="fas fa-chart-line"></i> è‚¡ç¥¨è¡Œä¸šèµ°åŠ¿é¢„æµ‹
        </h3>
        
        <div class="prediction-summary">
          <div class="summary-title">ä»Šæ—¥è¡Œä¸šåˆ†ææ‘˜è¦</div>
          <div id="predictionSummary">
            <p style="color:#184574;">åŸºäºæœ€æ–°æ–°é—»æ·±åº¦åˆ†æï¼Œç³»ç»Ÿå°†ä¸ºæ‚¨æä¾›å„è¡Œä¸šè‚¡ç¥¨æŠ•èµ„å»ºè®®...</p>
          </div>
        </div>

        <div class="prediction-card">
          <div id="predictionsContainer">
            <div class="loading">
              <p>åˆ†ææ–°é—»å½±å“ä¸­...</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
  <script>
    // æ¨¡æ‹Ÿè·¯é€ç¤¾æ–°é—»æ•°æ®ï¼ˆå®é™…åº”ç”¨ä¸­éœ€è¦æ¥å…¥çœŸå®APIï¼‰
    const mockReutersNews = [
      {
        title: "ç¾è”å‚¨æš—ç¤ºå¯èƒ½è¿›ä¸€æ­¥åŠ æ¯ é‡‘èå¸‚åœºéœ‡è¡",
        content: "ç¾è”å‚¨å®˜å‘˜åœ¨æœ€æ–°è®²è¯ä¸­è¡¨ç¤ºï¼Œä¸ºæŠ‘åˆ¶é€šèƒ€å¯èƒ½éœ€è¦è¿›ä¸€æ­¥æé«˜åˆ©ç‡ã€‚æ­¤æ¶ˆæ¯å¯¼è‡´å…¨çƒé‡‘èå¸‚åœºå‡ºç°å‰§çƒˆæ³¢åŠ¨ï¼Œç¾å…ƒæŒ‡æ•°ä¸Šæ¶¨ï¼Œæ–°å…´å¸‚åœºè´§å¸æ‰¿å‹ã€‚",
        time: "2025-10-04 09:30",
        source: "Reuters",
        impact: {
          banking: "negative",
          real_estate: "negative",
          technology: "negative",
          energy: "neutral",
          healthcare: "neutral"
        }
      },
      {
        title: "å…¨çƒèŠ¯ç‰‡éœ€æ±‚æ¿€å¢ åŠå¯¼ä½“è¡Œä¸šè¿æ¥æ–°ä¸€è½®å¢é•¿",
        content: "éšç€äººå·¥æ™ºèƒ½ã€5Gå’Œç”µåŠ¨æ±½è½¦éœ€æ±‚çš„å¿«é€Ÿå¢é•¿ï¼Œå…¨çƒåŠå¯¼ä½“éœ€æ±‚æŒç»­æ¿€å¢ã€‚å¤šå®¶èŠ¯ç‰‡åˆ¶é€ å•†ä¸Šè°ƒäº†å…¨å¹´ä¸šç»©é¢„æœŸï¼Œè¡Œä¸šå‰æ™¯çœ‹å¥½ã€‚",
        time: "2025-10-04 08:15",
        source: "Reuters",
        impact: {
          technology: "positive",
          automotive: "positive",
          manufacturing: "positive",
          energy: "neutral",
          finance: "neutral"
        }
      },
      {
        title: "ç»¿è‰²èƒ½æºæŠ•èµ„åˆ›å†å²æ–°é«˜ ä¼ ç»Ÿèƒ½æºé¢ä¸´è½¬å‹å‹åŠ›",
        content: "æœ€æ–°æŠ¥å‘Šæ˜¾ç¤ºï¼Œå…¨çƒæ¸…æ´èƒ½æºæŠ•èµ„åœ¨2025å¹´å°†è¾¾åˆ°åˆ›çºªå½•æ°´å¹³ã€‚å¤ªé˜³èƒ½å’Œé£èƒ½é¡¹ç›®è·å¾—å¤§é‡èµ„é‡‘æ”¯æŒï¼Œè€Œä¼ ç»ŸçŸ³æ²¹å¤©ç„¶æ°”å…¬å¸é¢ä¸´è½¬å‹å‹åŠ›ã€‚",
        time: "2025-10-04 07:45",
        source: "Reuters",
        impact: {
          renewable_energy: "positive",
          traditional_energy: "negative",
          utilities: "positive",
          materials: "positive",
          transportation: "neutral"
        }
      }
    ];

    // è¡Œä¸šä¸­æ–‡åç§°æ˜ å°„
    const sectorNames = {
      banking: "é“¶è¡Œé‡‘è",
      real_estate: "æˆ¿åœ°äº§",
      technology: "ç§‘æŠ€è‚¡",
      energy: "ä¼ ç»Ÿèƒ½æº",
      healthcare: "åŒ»ç–—å¥åº·",
      automotive: "æ±½è½¦åˆ¶é€ ",
      manufacturing: "åˆ¶é€ ä¸š",
      renewable_energy: "æ–°èƒ½æº",
      traditional_energy: "ä¼ ç»Ÿèƒ½æº",
      utilities: "å…¬ç”¨äº‹ä¸š",
      materials: "åŸææ–™",
      transportation: "äº¤é€šè¿è¾“",
      finance: "é‡‘èæœåŠ¡"
    };

    // å½±å“æè¿°
    const impactDescriptions = {
      positive: "çœ‹æ¶¨",
      negative: "çœ‹è·Œ", 
      neutral: "ä¸­æ€§"
    };

    // å¤šè¯­è¨€æ”¯æŒ
    const langData = {
      zh: {
        nav_title: "è‚¡ç¥¨è¡Œä¸šåˆ†æé¢„æµ‹ç³»ç»Ÿ",
        nav_about: "å…³äºç³»ç»Ÿ"
      },
      en: {
        nav_title: "Stock Market Analysis & Prediction System", 
        nav_about: "About System"
      }
    };

    function switchLang(lang) {
      document.getElementById("btn-en").classList.toggle("active", lang === "en");
      document.getElementById("btn-zh").classList.toggle("active", lang === "zh");
      
      for (const key in langData[lang]) {
        const el = document.getElementById(key);
        if (el) el.textContent = langData[lang][key];
      }
      
      localStorage.setItem('prediction_lang', lang);
    }

    // ç”Ÿæˆå››æ ¼æ¼«ç”»å†…å®¹
    function generateComic(news) {
      // æ ¹æ®æ–°é—»æ ‡é¢˜å…³é”®è¯ç”Ÿæˆå¯¹åº”çš„å››æ ¼æ¼«ç”»
      const title = news.title.toLowerCase();
      
      if (title.includes('ç¾è”å‚¨') || title.includes('åŠ æ¯') || title.includes('åˆ©ç‡')) {
        return {
          panel1: { image: 'images/comics/panel1_fed.png', emoji: 'ğŸ¦', text: 'ç¾è”å‚¨å¼€ä¼šè®¨è®ºåˆ©ç‡' },
          panel2: { image: 'images/comics/panel2_fed.png', emoji: 'ğŸ“ˆ', text: 'å†³å®šç»§ç»­åŠ æ¯æŠ—é€šèƒ€' },
          panel3: { image: 'images/comics/panel3_fed.png', emoji: 'ğŸ˜°', text: 'æŠ•èµ„è€…ä»¬å¼€å§‹ç´§å¼ ' },
          panel4: { image: 'images/comics/panel4_fed.png', emoji: 'ğŸ“‰', text: 'å¸‚åœºåº”å£°ä¸‹è·Œ' }
        };
      } else if (title.includes('èŠ¯ç‰‡') || title.includes('åŠå¯¼ä½“') || title.includes('ç§‘æŠ€')) {
        return {
          panel1: { image: 'images/comics/panel1_tech.png', emoji: 'ğŸ’»', text: 'AIéœ€æ±‚çˆ†å‘å¼å¢é•¿' },
          panel2: { image: 'images/comics/panel2_tech.png', emoji: 'ğŸ­', text: 'èŠ¯ç‰‡å·¥å‚åŠ ç­åŠ ç‚¹' },
          panel3: { image: 'images/comics/panel3_tech.png', emoji: 'ğŸ“Š', text: 'ä¸šç»©é¢„æœŸå¤§å¹…ä¸Šè°ƒ' },
          panel4: { image: 'images/comics/panel4_tech.png', emoji: 'ğŸš€', text: 'ç§‘æŠ€è‚¡å¼ºåŠ¿ä¸Šæ¶¨' }
        };
      } else if (title.includes('ç»¿è‰²') || title.includes('æ–°èƒ½æº') || title.includes('æ¸…æ´èƒ½æº')) {
        return {
          panel1: { image: 'images/comics/panel1_energy.png', emoji: 'ğŸŒ', text: 'å…¨çƒæ°”å€™å˜åŒ–åŠ å‰§' },
          panel2: { image: 'images/comics/panel2_energy.png', emoji: 'ğŸ’°', text: 'ç»¿è‰²èƒ½æºè·å·¨é¢æŠ•èµ„' },
          panel3: { image: 'images/comics/panel3_energy.png', emoji: 'â›½', text: 'ä¼ ç»Ÿèƒ½æºé¢ä¸´æŒ‘æˆ˜' },
          panel4: { image: 'images/comics/panel4_energy.png', emoji: 'ğŸ”‹', text: 'æ–°èƒ½æºè‚¡ç¥¨é£æ¶¨' }
        };
      } else {
        // é»˜è®¤é€šç”¨å››æ ¼æ¼«ç”»
        return {
          panel1: { image: 'images/comics/panel1_default.png', emoji: 'ğŸ“°', text: 'é‡å¤§æ–°é—»å‘å¸ƒ' },
          panel2: { image: 'images/comics/panel2_default.png', emoji: 'ğŸ¤”', text: 'å¸‚åœºå¼€å§‹ååº”' },
          panel3: { image: 'images/comics/panel3_default.png', emoji: 'ğŸ“±', text: 'æŠ•èµ„è€…å¯†åˆ‡å…³æ³¨' },
          panel4: { image: 'images/comics/panel4_default.png', emoji: 'ğŸ’¹', text: 'è‚¡ä»·å¼€å§‹æ³¢åŠ¨' }
        };
      }
    }

    function displayNews(newsData) {
      const container = document.getElementById('newsContainer');
      container.innerHTML = '';

      newsData.forEach((news, index) => {
        const newsCard = document.createElement('div');
        newsCard.className = 'news-card';
        
        let comicHtml = '';
        // ä¸ºç¬¬ä¸€ä¸ªæ–°é—»æ·»åŠ å››æ ¼æ¼«ç”»
        if (index === 0) {
          const comic = generateComic(news);
          comicHtml = `
            <div class="comic-container">
              <div class="comic-title">ğŸ“° æ–°é—»å››æ ¼æ¼«ç”»è§£è¯»</div>
              <div class="comic-grid">
                <div class="comic-panel">
                  <div class="comic-panel-number">1</div>
                  <img class="comic-image" src="${comic.panel1.image}" alt="Panel 1" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                  <div class="comic-emoji" style="display:none;">${comic.panel1.emoji}</div>
                  <div class="comic-text">${comic.panel1.text}</div>
                </div>
                <div class="comic-panel">
                  <div class="comic-panel-number">2</div>
                  <img class="comic-image" src="${comic.panel2.image}" alt="Panel 2" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                  <div class="comic-emoji" style="display:none;">${comic.panel2.emoji}</div>
                  <div class="comic-text">${comic.panel2.text}</div>
                </div>
                <div class="comic-panel">
                  <div class="comic-panel-number">3</div>
                  <img class="comic-image" src="${comic.panel3.image}" alt="Panel 3" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                  <div class="comic-emoji" style="display:none;">${comic.panel3.emoji}</div>
                  <div class="comic-text">${comic.panel3.text}</div>
                </div>
                <div class="comic-panel">
                  <div class="comic-panel-number">4</div>
                  <img class="comic-image" src="${comic.panel4.image}" alt="Panel 4" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                  <div class="comic-emoji" style="display:none;">${comic.panel4.emoji}</div>
                  <div class="comic-text">${comic.panel4.text}</div>
                </div>
              </div>
            </div>
          `;
        }
        
        newsCard.innerHTML = `
          <div class="news-source">${news.source} â€¢ ${news.time}</div>
          <div class="news-title">${news.title}</div>
          <div class="news-content">${news.content}</div>
          ${comicHtml}
        `;
        container.appendChild(newsCard);
      });
    }

    function generatePredictions(newsData) {
      const sectorImpacts = {};
      
      // åˆ†ææ¯æ¡æ–°é—»å¯¹å„è¡Œä¸šçš„å½±å“
      newsData.forEach(news => {
        for (const [sector, impact] of Object.entries(news.impact)) {
          if (!sectorImpacts[sector]) {
            sectorImpacts[sector] = { positive: 0, negative: 0, neutral: 0 };
          }
          sectorImpacts[sector][impact]++;
        }
      });

      // ç”Ÿæˆé¢„æµ‹ç»“æœ
      const predictions = [];
      for (const [sector, impacts] of Object.entries(sectorImpacts)) {
        const total = impacts.positive + impacts.negative + impacts.neutral;
        let overallImpact = 'neutral';
        let confidence = 50;

        if (impacts.positive > impacts.negative) {
          overallImpact = 'positive';
          confidence = Math.round((impacts.positive / total) * 100);
        } else if (impacts.negative > impacts.positive) {
          overallImpact = 'negative';
          confidence = Math.round((impacts.negative / total) * 100);
        }

        predictions.push({
          sector: sector,
          impact: overallImpact,
          confidence: confidence,
          reasoning: generateReasoning(sector, overallImpact, newsData)
        });
      }

      return predictions.sort((a, b) => b.confidence - a.confidence);
    }

    function generateReasoning(sector, impact, newsData) {
      const sectorName = sectorNames[sector] || sector;
      const impactText = impactDescriptions[impact];
      
      // ç®€åŒ–çš„æ¨ç†é€»è¾‘
      const reasons = [];
      newsData.forEach(news => {
        if (news.impact[sector] === impact) {
          reasons.push(`å—"${news.title}"å½±å“`);
        }
      });
      
      return `${sectorName}${impactText}ï¼š${reasons.join('ï¼›')}ã€‚`;
    }

    function displayPredictions(predictions) {
      const container = document.getElementById('predictionsContainer');
      container.innerHTML = '';

      // ç”Ÿæˆé¢„æµ‹æ‘˜è¦
      const topPredictions = predictions.slice(0, 3);
      const summaryText = `ä»Šæ—¥æœ€å€¼å¾—å…³æ³¨çš„è‚¡ç¥¨è¡Œä¸šï¼š${topPredictions.map(p => 
        `${sectorNames[p.sector]}(${impactDescriptions[p.impact]})`
      ).join('ã€')}`;
      
      document.getElementById('predictionSummary').innerHTML = `
        <p style="color:#184574; font-size:1.1rem; margin:0;">${summaryText}</p>
      `;

      // æ˜¾ç¤ºè¯¦ç»†é¢„æµ‹
      predictions.forEach(prediction => {
        const sectorDiv = document.createElement('div');
        sectorDiv.className = 'sector-item';
        
        const impactClass = prediction.impact === 'positive' ? 'impact-positive' : 
                           prediction.impact === 'negative' ? 'impact-negative' : 'impact-neutral';
        
        sectorDiv.innerHTML = `
          <div class="sector-name">${sectorNames[prediction.sector] || prediction.sector}</div>
          <div class="sector-impact">
            <span class="${impactClass}">${impactDescriptions[prediction.impact]} (ç½®ä¿¡åº¦: ${prediction.confidence}%)</span>
          </div>
          <div style="color:#6c757d; font-size:0.95rem; margin-top:8px;">
            ${prediction.reasoning}
          </div>
        `;
        
        container.appendChild(sectorDiv);
      });
    }

    function refreshNews() {
      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      document.getElementById('newsContainer').innerHTML = `
        <div class="loading">
          <div class="spinner-border text-primary" role="status">
            <span class="sr-only">åŠ è½½ä¸­...</span>
          </div>
          <p>æ­£åœ¨è·å–è·¯é€ç¤¾æœ€æ–°æ–°é—»...</p>
        </div>
      `;

      document.getElementById('predictionsContainer').innerHTML = `
        <div class="loading">
          <p>åˆ†ææ–°é—»å½±å“ä¸­...</p>
        </div>
      `;

      // æ¨¡æ‹ŸAPIè°ƒç”¨å»¶è¿Ÿ
      setTimeout(() => {
        displayNews(mockReutersNews);
        const predictions = generatePredictions(mockReutersNews);
        displayPredictions(predictions);
      }, 2000);
    }

    // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
      const userLang = localStorage.getItem('prediction_lang') || 'zh';
      switchLang(userLang);
      refreshNews();
    });
  </script>
</body>
</html>
